#%Module#####################################################################

conflict mpich

    proc ModulesHelp { } {
    global helpmsg
    puts stderr "\t$helpmsg\n"
}

set pgiversion 14.4
set libversion 3.0.4

set kern [ exec uname -s ]
if { $kern == "Linux" } {
  set target linux86-64
} elseif { $kern == "Darwin" } {
  set target osx86-64
}

set libdir /share/apps/opt/pgi/linux86-64/2014/mpi/mpich

if [ file isdirectory $libdir ] {
    module-whatis "Adds optional mpich-$libversion library from PGI $pgiversion to environment"
    set helpmsg "
Purpose
-------
  This module file defines the system paths and environment variables
  needed to use MPICH version $libversion with the PGI Compilers and Tools
  version $pgiversion.  The available compiler wrappers are mpicc, mpicxx,
  mpif77, and mpif90.


Module Dependencies
-------------------
  pgi


Product Description
-------------------
  MPICH is a high-performance and widely portable implementation of the
  Message Passing Interface (MPI) standard (MPI-1, MPI-2 and MPI-3).
  The goals of MPICH are: (1) to provide an MPI implementation that
  efficiently supports different computation and communication
  platforms including commodity clusters (desktop systems, shared-memory
  systems, multicore architectures), high-speed networks (10 Gigabit
  Ethernet, InfiniBand, Myrinet, Quadrics) and proprietary high-end
  computing systems (Blue Gene, Cray) and (2) to enable cutting-edge
  research in MPI through an easy-to-extend modular framework for other
  derived implementations.


Product and OS Dependencies
---------------------------
  For more information about MPICH, see the following URL:

    http://www.mpich.org/


Documentation
-------------
  Documentation for MPICH $libversion is available in $libdir/share/doc/mpich/
  MPICH $libversion Installation Guide            install.pdf
  MPICH $libversion User's Guide                  user.pdf
  MPICH Logging                             logging.pdf
  SPMD PMI Wire Protocol Reference Manual   smpd_pmi.pdf
"
    prepend-path PGI_OPTL_INCLUDE_DIRS "$libdir/include"
    prepend-path PGI_OPTL_LIB_DIRS "$libdir/lib"
    prepend-path PATH $libdir/bin
    prepend-path MANPATH $libdir/share/man
    if { $kern == "Linux" } {
	prepend-path LD_LIBRARY_PATH $libdir/lib
    } elseif { $kern == "Darwin" } {
	prepend-path DYLD_LIBRARY_PATH $libdir/lib
    }
} else {
    module-whatis "Optional libraries for PGI $pgiversion not installed"
    set helpmsg "Optional libraries for PGI $pgiversion not installed"
    if [ expr [ module-info mode load ] || [ module-info mode display ] ] {
        # bring in new pgiversion
        puts stderr "Optional libraries for PGI $pgiversion not installed on [uname nodename]"
    }
}
